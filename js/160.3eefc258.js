"use strict";(self["webpackChunkvue_week6"]=self["webpackChunkvue_week6"]||[]).push([[160],{1160:function(t,e,a){a.r(e),a.d(e,{default:function(){return R}});var s=a(3396),c=a(7139),l=a(9242);const i=t=>((0,s.dD)("data-v-6c7ff6c2"),t=t(),(0,s.Cn)(),t),o={key:0,class:"mb-10"},n=(0,s.uE)('<li class="row py-4 bg-secondary" data-v-6c7ff6c2><div class="col-lg-4" data-v-6c7ff6c2><p class="text-center text-c-white" data-v-6c7ff6c2>商品</p></div><div class="col-lg-2" data-v-6c7ff6c2><p class="text-center text-c-white" data-v-6c7ff6c2>數量</p></div><div class="col-lg-2" data-v-6c7ff6c2><p class="text-center text-c-white" data-v-6c7ff6c2>售價</p></div><div class="col-lg-2" data-v-6c7ff6c2><p class="text-center text-c-white" data-v-6c7ff6c2>小計</p></div><div class="col-lg-2" data-v-6c7ff6c2><p class="text-center text-c-white" data-v-6c7ff6c2>操作</p></div></li>',1),r={class:"col-lg-4 d-flex jy-content-center"},d={class:"content px-3"},u={class:"text-medium"},p=i((()=>(0,s._)("br",null,null,-1))),h={class:"col-lg-2"},g=["onUpdate:modelValue","onChange"],f=["value"],m={class:"col-lg-2"},v={class:"text-medium text-center text-c-primary"},_={class:"col-lg-2"},x={class:"text-medium text-center text-c-primary"},y={class:"col-lg-2"},w=["onClick"],b=i((()=>(0,s._)("span",{class:"text-c-white"}," X ",-1))),k=[b],C={class:"row py-4 bg-white align-items-center border-b-1 jy-content-end"},$=i((()=>(0,s._)("div",{class:"col-lg-2"},[(0,s._)("p",{class:"text-medium text-center text-c-primary"},"總計")],-1))),z={class:"col-lg-2"},j={class:"text-medium text-center text-c-primary f-size-s"},T={class:"row py-6 bg-white jy-content-between"},D={class:"col-lg-4 d-flex flex-dir-col jy-content-between"},L={class:"coupon d-flex"},q=["readonly"],U=["disabled"],N={key:0},V={key:1},H={class:"text-medium d-flex jy-content-between"},M=i((()=>(0,s._)("span",null,"商品小計",-1))),Y={class:"text-c-primary f-w-bold"},B={class:"text-medium d-flex jy-content-between"},I=i((()=>(0,s._)("span",null,"優惠折扣",-1))),K={class:"text-c-primary f-w-bold"},W={class:"col-lg-4"},E=(0,s.Uk)(" 結帳金額"),F=i((()=>(0,s._)("br",null,null,-1))),X={class:"text-c-primary f-size-s f-w-bold my-2 d-block"},Z={class:"empty-cart mb-20"},A=i((()=>(0,s._)("h3",{class:"text-title text-c-forthary text-center mb-4"},"購物車是空的",-1))),G=i((()=>(0,s._)("button",{class:"user-btn user-btn-primary mx-auto py-4 px-10 f-size-s"},"前往選購商品",-1)));function J(t,e,a,i,b,J){const O=(0,s.up)("LoadingView"),P=(0,s.up)("router-link");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(O,{active:b.isLoading},null,8,["active"]),b.carts?.carts?.length?((0,s.wg)(),(0,s.iD)("ul",o,[n,((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(b.carts.carts,(t=>((0,s.wg)(),(0,s.iD)("li",{class:"row py-4 bg-white align-items-center border-b-1",key:t.id},[(0,s._)("div",r,[(0,s._)("div",{class:"img-bg px-1",style:(0,c.j5)({backgroundImage:"url("+t.product.imageUrl+")"})},null,4),(0,s._)("div",d,[(0,s._)("h3",u,(0,c.zw)(t.product.title),1),(0,s._)("p",null,[(0,s.Uk)(" 規格："+(0,c.zw)(t.product.unit),1),p,(0,s.Uk)(" 重量："+(0,c.zw)(t.product.content),1)])])]),(0,s._)("div",h,[(0,s.wy)((0,s._)("select",{class:"py-2",name:"qty",id:"qty","onUpdate:modelValue":e=>t.qty=e,onChange:e=>J.updateCart(t,t.qty)},[((0,s.wg)(),(0,s.iD)(s.HY,null,(0,s.Ko)(20,((t,e)=>(0,s._)("option",{key:t+e,value:t},(0,c.zw)(t),9,f))),64))],40,g),[[l.bM,t.qty]])]),(0,s._)("div",m,[(0,s._)("p",v," NT $"+(0,c.zw)(t.product.price),1)]),(0,s._)("div",_,[(0,s._)("p",x," NT $"+(0,c.zw)(t.total),1)]),(0,s._)("div",y,[(0,s._)("button",{type:"button",class:"user-btn user-btn-primary m-auto py-1 px-2",onClick:e=>J.deleteCart(t.id)},k,8,w)])])))),128)),(0,s._)("li",C,[$,(0,s._)("div",z,[(0,s._)("p",j," NT $"+(0,c.zw)(b.carts.total),1)])]),(0,s._)("li",T,[(0,s._)("div",D,[(0,s._)("div",L,[(0,s.wy)((0,s._)("input",{class:"w-60 p-2 f-size-xs",type:"text",id:"coupon","onUpdate:modelValue":e[0]||(e[0]=t=>b.coupon=t),readonly:b.carts.total!==b.carts.final_total},null,8,q),[[l.nr,b.coupon]]),(0,s._)("button",{class:"user-btn user-btn-primary py-2 flex-auto",type:"button",onClick:e[1]||(e[1]=(...t)=>J.useCoupon&&J.useCoupon(...t)),disabled:b.carts.total!==b.carts.final_total},[b.carts.total==b.carts.final_total?((0,s.wg)(),(0,s.iD)("span",N,"使用優惠卷")):((0,s.wg)(),(0,s.iD)("span",V,"已使用過優惠卷"))],8,U)]),(0,s._)("p",H,[M,(0,s._)("span",Y,"NT$ "+(0,c.zw)(b.carts.total),1)]),(0,s._)("p",B,[I,(0,s._)("span",K," NT$ "+(0,c.zw)(Math.round(b.carts.total-b.carts.final_total)),1)])]),(0,s._)("div",W,[(0,s._)("p",null,[E,F,(0,s._)("span",X," NT$ "+(0,c.zw)(Math.round(b.carts.final_total)),1)]),(0,s._)("button",{class:"user-btn user-btn-primary w-100 py-3 f-size-xs",type:"button",onClick:e[2]||(e[2]=(...t)=>J.routerTo&&J.routerTo(...t))},"下一步：填寫資料")])])])):(0,s.kq)("",!0),(0,s.wy)((0,s._)("div",Z,[A,(0,s.Wm)(P,{to:"/product"},{default:(0,s.w5)((()=>[G])),_:1})],512),[[l.F8,0===b.carts?.carts?.length]])],64)}var O={data(){return{isLoading:!1,carts:[],coupon:""}},methods:{getCarts(){this.isLoading=!0,this.$http.get("https://vue3-course-api.hexschool.io/v2/api/ginjack/cart").then((t=>{if(this.isLoading=!1,this.carts=t.data.data,0===this.carts.carts.length)return this.$emitter.emit("changeBar",0),void this.$emitter.emit("updateCart",t.data.data);this.$emitter.emit("updateCart",t.data.data),this.$emitter.emit("changeBar",1)})).catch((t=>{console.log(t)}))},updateCart(t,e){this.isLoading=!0;const a={product_id:t.product_id,qty:e};this.$http.put(`https://vue3-course-api.hexschool.io/v2/api/ginjack/cart/${t.id}`,{data:a}).then((t=>{this.getCarts()})).catch((t=>{console.dir(t)}))},deleteCart(t){this.isLoading=!0,this.$http.delete(`https://vue3-course-api.hexschool.io/v2/api/ginjack/cart/${t}`).then((t=>{this.getCarts()})).catch((t=>{console.dir(t)}))},useCoupon(){if(""===this.coupon)return void alert("欄位不可為空");this.isLoading=!0;const t={code:this.coupon};this.$http.post("https://vue3-course-api.hexschool.io/v2/api/ginjack/coupon",{data:t}).then((t=>{this.getCarts()})).catch((t=>{console.dir(t)}))},routerTo(){this.$router.push({name:"資料輸入頁面",params:{show:!0}})}},mounted(){this.getCarts()}},P=a(89);const Q=(0,P.Z)(O,[["render",J],["__scopeId","data-v-6c7ff6c2"]]);var R=Q}}]);
//# sourceMappingURL=160.3eefc258.js.map